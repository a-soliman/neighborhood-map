"use strict";var map=void 0,infoWindow=void 0,markers=[],backupLocations=[{name:"The Trident",position:{lat:37.853405,lng:-122.478708},image:"https://s3-media3.fl.yelpcdn.com/bphoto/SavnswRo8GIvK1nKc-boyA/o.jpg",rating:3.5,address:"558 Bridgeway",highlighted:ko.observable(!1)},{name:"Napa Valley Burger Company",position:{lat:37.854616,lng:-122.479051},image:"https://s3-media2.fl.yelpcdn.com/bphoto/c4qNa-lDiZkMWRCirX1lgA/o.jpg",rating:4,address:"670 Bridgeway",highlighted:ko.observable(!1)},{name:"Barrel House Tavern",position:{lat:37.855221,lng:-122.478831},image:"https://s3-media3.fl.yelpcdn.com/bphoto/ndYSXvbqcxIthPof8nNbow/o.jpg",rating:3.5,address:"660 Bridgeway",highlighted:ko.observable(!1)},{name:"Lighthouse Cafe",position:{lat:37.856413,lng:-122.480081},image:"https://s3-media4.fl.yelpcdn.com/bphoto/rx9px8mrxgCFKU0img12MA/o.jpg",rating:4,address:"1311 Bridgeway",highlighted:ko.observable(!1)},{name:"Seafood Peddler",position:{lat:37.856567,lng:-122.478235},image:"https://s3-media1.fl.yelpcdn.com/bphoto/p6xdlY3vpG-G7WeGAFYOyA/o.jpg",rating:3.5,address:"303 Johnson St",highlighted:ko.observable(!1)}];function AppViewModel(){var t=this;t.spinner=ko.observable(!1),t.locations=ko.observableArray(),t.filteredLocations=ko.observableArray(),t.filterString=ko.observable(""),t.signalHighlited=function(n){for(var e=n.name,o=0;o<t.locations().length;o++){var i=t.locations()[o];if(i.name==e){i.highlighted(!0);var a=markers.filter(function(n){return n.name==e})[0];a&&(t.animateBouncing(a),t.displayInfoWindow(a))}else i.highlighted(!1)}},t.animateBouncing=function(e){markers.forEach(function(n){n==e?n.setAnimation(google.maps.Animation.BOUNCE):n.setAnimation(null)})},t.displayInfoWindow=function(n){infoWindow.setContent('\n            <div class="infoWindow">\n                <h3 class="name">'+n.name+'</h3>\n                <h4 class="rating">Yelp Rating: '+n.rating+"</h4>\n                <p>"+n.address+'</p>\n                <img src="'+n.image+'">\n            </div>\n            '),infoWindow.open(map,n)},t.search=function(){var e=t.filterString();if(0<e.length){var n=t.locations().filter(function(n){return n.name.toLowerCase().includes(e)});t.filteredLocations(n)}else t.filteredLocations([]);t.filterMarkers(e)},t.filterMarkers=function(e){var n=markers.filter(function(n){return-1==n.name.toLowerCase().indexOf(e)}),o=markers.filter(function(n){return-1!=n.name.toLowerCase().indexOf(e)});n.forEach(function(n){n.setMap(null)}),o.forEach(function(n){n.setMap(map)})},t.toggleNav=function(){var n=$(".list-container"),e=$(".toggle-icon");n.toggle(),n.is(":visible")?e.removeClass("fa-arrow-right").addClass("fa-arrow-left"):e.removeClass("fa-arrow-left").addClass("fa-arrow-right")}}var viewModel=new AppViewModel;function initMap(){var n=document.getElementById("map");map=new google.maps.Map(n,{center:{lat:37.855221,lng:-122.478831},zoom:14,mapTypeId:"roadmap"}),viewModel.locations().forEach(function(n,e){var o=new google.maps.Marker({position:n.position,map:map,name:n.name,image:n.image,rating:n.rating,address:n.address,id:e});infoWindow=new google.maps.InfoWindow,o.addListener("click",function(){infoWindow.setContent('\n            <div class="infoWindow">\n                <h3 class="name">'+o.name+'</h3>\n                <h4 class="rating">Yelp Rating: '+o.rating+"</h4>\n                <p>"+o.address+'</p>\n                <img src="'+o.image+'">\n            </div>\n            '),infoWindow.open(map,o),viewModel.signalHighlited(o)}),markers.push(o)})}function getLocationsFromYelp(){fetch("http://localhost:3333").then(function(n){200===n.status?n.json().then(function(n){n.forEach(function(n){n.highlighted=ko.observable(!1)}),viewModel.locations(n),initMap()}):n.json().then(function(n){console.log("check the backend"),viewModel.locations(backupLocations),initMap()})}).catch(function(n){console.log("Fetch Error :-S",n),viewModel.locations(backupLocations),initMap()})}getLocationsFromYelp(),ko.applyBindings(viewModel);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsibWFwIiwiaW5mb1dpbmRvdyIsIm1hcmtlcnMiLCJiYWNrdXBMb2NhdGlvbnMiLCJuYW1lIiwibGF0IiwibG5nIiwicG9zaXRpb24iLCJpbWFnZSIsInJhdGluZyIsImFkZHJlc3MiLCJrbyIsIm9ic2VydmFibGUiLCJoaWdobGlnaHRlZCIsIkFwcFZpZXdNb2RlbCIsInNlbGYiLCJmaWx0ZXJlZExvY2F0aW9ucyIsInNwaW5uZXIiLCJsb2NhdGlvbnMiLCJvYnNlcnZhYmxlQXJyYXkiLCJmaWx0ZXJTdHJpbmciLCJpIiwic2lnbmFsSGlnaGxpdGVkIiwiZGF0YSIsImxvY2F0aW9uIiwibGVuZ3RoIiwibWFya2VyIiwiZGlzcGxheUluZm9XaW5kb3ciLCJpdGVtIiwiYW5pbWF0ZUJvdW5jaW5nIiwiZ2l2ZW5NYXJrZXIiLCJzZXRBbmltYXRpb24iLCJnb29nbGUiLCJtYXBzIiwiQW5pbWF0aW9uIiwiQk9VTkNFIiwic2VhcmNoIiwidmFsdWUiLCJtYXJrZXJzVG9IaWRlIiwicmVzdWx0IiwiZmlsdGVyIiwiaW5kZXhPZiIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJmaWx0ZXJNYXJrZXJzIiwibmF2Q29udGFpbmVyIiwidG9nZ2xlSWNvbiIsIiQiLCJyZW1vdmVDbGFzcyIsInNldE1hcCIsInZpZXdNb2RlbCIsInRvZ2dsZSIsIm1hcENvbnRhaW5lciIsImRvY3VtZW50IiwibWFwT3B0aW9ucyIsImFkZENsYXNzIiwibWFwVHlwZUlkIiwic2V0Q29udGVudCIsImNlbnRlciIsInpvb20iLCJmb3JFYWNoIiwiTWFya2VyIiwiZ2V0TG9jYXRpb25zRnJvbVllbHAiLCJyZXNwb25zZSIsImluaXRNYXAiLCJhZGRMaXN0ZW5lciIsImVyciIsImNvbnNvbGUiLCJwdXNoIiwiZmV0Y2giLCJ0aGVuIiwic3RhdHVzIiwianNvbiIsImxvZyIsImNhdGNoIiwiYXBwbHlCaW5kaW5ncyJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBSUEs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Q1hBLEVBQUtmLFlBQWNGLEdBQUdDLFlBQVcsS0FFckNzQyxVQUFVaEMsVUFBVUssR0FDcEJ5QyxZQWJBRCxFQUFTUyxPQUFPRixLQUFNLFNBQUUvQyxHQUNwQjRDLFFBQVFNLElBQUkscUJBQ1p2QixVQUFVaEMsVUFBVWYsaUJBQ3BCNkQsY0FhWFUsTUFBTyxTQUFVUixHQUNkQyxRQUFRTSxJQUFJLGtCQUFtQlAsR0FDL0JoQixVQUFVaEMsVUFBVWYsaUJBQ3BCNkQsWUFJWkYsdUJBR0FuRCxHQUFHZ0UsY0FBY3pCIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBHTE9CQUwgVkFSSUFCTEVTICovXHJcbmxldCBtYXA7XHJcbmxldCBpbmZvV2luZG93O1xyXG5jb25zdCBtYXJrZXJzID0gW107XHJcbmNvbnN0IGJhY2t1cExvY2F0aW9ucyA9IFtcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAnVGhlIFRyaWRlbnQnLFxyXG4gICAgICAgIHBvc2l0aW9uOiB7bGF0OiAzNy44NTM0MDUsIGxuZzogLTEyMi40Nzg3MDh9LFxyXG4gICAgICAgIGltYWdlOiAnaHR0cHM6Ly9zMy1tZWRpYTMuZmwueWVscGNkbi5jb20vYnBob3RvL1Nhdm5zd1JvOEdJdksxbktjLWJveUEvby5qcGcnLFxyXG4gICAgICAgIHJhdGluZzogMy41LFxyXG4gICAgICAgIGFkZHJlc3M6ICc1NTggQnJpZGdld2F5JyxcclxuICAgICAgICBoaWdobGlnaHRlZDoga28ub2JzZXJ2YWJsZShmYWxzZSlcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ05hcGEgVmFsbGV5IEJ1cmdlciBDb21wYW55JyxcclxuICAgICAgICBwb3NpdGlvbjoge2xhdDogMzcuODU0NjE2LCBsbmc6IC0xMjIuNDc5MDUxfSxcclxuICAgICAgICBpbWFnZTogJ2h0dHBzOi8vczMtbWVkaWEyLmZsLnllbHBjZG4uY29tL2JwaG90by9jNHFOYS1sRGlaa01XUkNpclgxbGdBL28uanBnJyxcclxuICAgICAgICByYXRpbmc6IDQsXHJcbiAgICAgICAgYWRkcmVzczogJzY3MCBCcmlkZ2V3YXknLFxyXG4gICAgICAgIGhpZ2hsaWdodGVkOiBrby5vYnNlcnZhYmxlKGZhbHNlKVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAnQmFycmVsIEhvdXNlIFRhdmVybicsXHJcbiAgICAgICAgcG9zaXRpb246IHtsYXQ6IDM3Ljg1NTIyMSwgbG5nOiAtMTIyLjQ3ODgzMX0sXHJcbiAgICAgICAgaW1hZ2U6ICdodHRwczovL3MzLW1lZGlhMy5mbC55ZWxwY2RuLmNvbS9icGhvdG8vbmRZU1h2YnFjeEl0aFBvZjhuTmJvdy9vLmpwZycsXHJcbiAgICAgICAgcmF0aW5nOiAzLjUsXHJcbiAgICAgICAgYWRkcmVzczogJzY2MCBCcmlkZ2V3YXknLFxyXG4gICAgICAgIGhpZ2hsaWdodGVkOiBrby5vYnNlcnZhYmxlKGZhbHNlKVxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOiAnTGlnaHRob3VzZSBDYWZlJyxcclxuICAgICAgICBwb3NpdGlvbjoge2xhdDogMzcuODU2NDEzLCBsbmc6IC0xMjIuNDgwMDgxfSxcclxuICAgICAgICBpbWFnZTogJ2h0dHBzOi8vczMtbWVkaWE0LmZsLnllbHBjZG4uY29tL2JwaG90by9yeDlweDhtcnhnQ0ZLVTBpbWcxMk1BL28uanBnJyxcclxuICAgICAgICByYXRpbmc6IDQsXHJcbiAgICAgICAgYWRkcmVzczogJzEzMTEgQnJpZGdld2F5JyxcclxuICAgICAgICBoaWdobGlnaHRlZDoga28ub2JzZXJ2YWJsZShmYWxzZSlcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTogJ1NlYWZvb2QgUGVkZGxlcicsXHJcbiAgICAgICAgcG9zaXRpb246IHtsYXQ6IDM3Ljg1NjU2NywgbG5nOiAtMTIyLjQ3ODIzNX0sXHJcbiAgICAgICAgaW1hZ2U6ICdodHRwczovL3MzLW1lZGlhMS5mbC55ZWxwY2RuLmNvbS9icGhvdG8vcDZ4ZGxZM3ZwRy1HN1dlR0FGWU95QS9vLmpwZycsXHJcbiAgICAgICAgcmF0aW5nOiAzLjUsXHJcbiAgICAgICAgYWRkcmVzczogJzMwMyBKb2huc29uIFN0JyxcclxuICAgICAgICBoaWdobGlnaHRlZDoga28ub2JzZXJ2YWJsZShmYWxzZSlcclxuICAgIH1cclxuXTtcclxuXHJcblxyXG4vKiBLTyAqL1xyXG5mdW5jdGlvbiBBcHBWaWV3TW9kZWwoKSB7XHJcbiAgICBjb25zdCBzZWxmID0gdGhpcztcclxuXHJcbiAgICBzZWxmLnNwaW5uZXIgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcclxuICAgIHNlbGYubG9jYXRpb25zID0ga28ub2JzZXJ2YWJsZUFycmF5KCk7XHJcblxyXG4gICAgc2VsZi5maWx0ZXJlZExvY2F0aW9ucyA9IGtvLm9ic2VydmFibGVBcnJheSgpO1xyXG4gICAgc2VsZi5maWx0ZXJTdHJpbmcgPSBrby5vYnNlcnZhYmxlKCcnKTtcclxuXHJcbiAgICAvKiBTSU5HQUwgSElHSExJR0hUIFNUQVRFIFRPIFRIRSBWSUVXTU9ERUwgKi9cclxuICAgIHNlbGYuc2lnbmFsSGlnaGxpdGVkID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBsZXQgbmFtZSA9IGRhdGEubmFtZTtcclxuICAgICAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBzZWxmLmxvY2F0aW9ucygpLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICBsZXQgbG9jYXRpb24gPSBzZWxmLmxvY2F0aW9ucygpW2ldO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIGxvY2F0aW9uLm5hbWUgPT0gbmFtZSApIHtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhpZ2hsaWdodGVkKHRydWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBtYXJrZXIgPSBtYXJrZXJzLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5uYW1lID09IG5hbWUpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggbWFya2VyICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFuaW1hdGVCb3VuY2luZyhtYXJrZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRpc3BsYXlJbmZvV2luZG93KG1hcmtlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhpZ2hsaWdodGVkKGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIC8qICBTRVQgQk9VTlNJTkcgQU5JTUFUSU9OIE9OIE1BUktFUiAqL1xyXG4gICAgc2VsZi5hbmltYXRlQm91bmNpbmcgPSBmdW5jdGlvbiAoZ2l2ZW5NYXJrZXIpIHtcclxuICAgICAgICBtYXJrZXJzLmZvckVhY2goKCBtYXJrZXIgKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICggbWFya2VyID09IGdpdmVuTWFya2VyICkge1xyXG4gICAgICAgICAgICAgICAgbWFya2VyLnNldEFuaW1hdGlvbihnb29nbGUubWFwcy5BbmltYXRpb24uQk9VTkNFKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRBbmltYXRpb24obnVsbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfTtcclxuXHJcbiAgICAvKiBESVNQTEFZUyBBTiBJTkZPV0lORE9XIElGIEEgUkVTVEFVUkFOVCBJUyBISUdITElHSFRFRCAqL1xyXG4gICAgc2VsZi5kaXNwbGF5SW5mb1dpbmRvdyA9IGZ1bmN0aW9uKG1hcmtlcikge1xyXG4gICAgICAgIGluZm9XaW5kb3cuc2V0Q29udGVudCggYFxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiaW5mb1dpbmRvd1wiPlxyXG4gICAgICAgICAgICAgICAgPGgzIGNsYXNzPVwibmFtZVwiPiR7bWFya2VyLm5hbWV9PC9oMz5cclxuICAgICAgICAgICAgICAgIDxoNCBjbGFzcz1cInJhdGluZ1wiPlllbHAgUmF0aW5nOiAke21hcmtlci5yYXRpbmd9PC9oND5cclxuICAgICAgICAgICAgICAgIDxwPiR7bWFya2VyLmFkZHJlc3N9PC9wPlxyXG4gICAgICAgICAgICAgICAgPGltZyBzcmM9XCIke21hcmtlci5pbWFnZX1cIj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIGApXHJcbiAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAsIG1hcmtlcik7XHJcbiAgICB9XHJcblxyXG4gICAgc2VsZi5zZWFyY2ggPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSBzZWxmLmZpbHRlclN0cmluZygpO1xyXG5cclxuICAgICAgICBpZiAoIHZhbHVlLmxlbmd0aCA+IDAgKSB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBzZWxmLmxvY2F0aW9ucygpLmZpbHRlcigoIGxvY2F0aW9uICkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvY2F0aW9uLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBzZWxmLmZpbHRlcmVkTG9jYXRpb25zKHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLmZpbHRlcmVkTG9jYXRpb25zKFtdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5maWx0ZXJNYXJrZXJzKHZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWxmLmZpbHRlck1hcmtlcnMgPSBmdW5jdGlvbiggdmFsdWUgKSB7XHJcbiAgICAgICAgbGV0IG1hcmtlcnNUb0hpZGUgPSBtYXJrZXJzLmZpbHRlcigoIG1hcmtlciApID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIG1hcmtlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih2YWx1ZSkgPT0gLTE7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGV0IG1hcmtlcnNUb0Rpc3BsYXkgPSBtYXJrZXJzLmZpbHRlcigoIG1hcmtlciApID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIG1hcmtlci5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih2YWx1ZSkgIT0gLTE7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbWFya2Vyc1RvSGlkZS5mb3JFYWNoKCggbWFya2VyICkgPT4ge1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG1hcmtlcnNUb0Rpc3BsYXkuZm9yRWFjaCgoIG1hcmtlciApID0+IHtcclxuICAgICAgICAgICAgbWFya2VyLnNldE1hcChtYXApO1xyXG4gICAgICAgIH0pXHJcbiAgICB9O1xyXG5cclxuICAgIHNlbGYudG9nZ2xlTmF2ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IG5hdkNvbnRhaW5lciA9ICQoJy5saXN0LWNvbnRhaW5lcicpO1xyXG4gICAgICAgIGxldCB0b2dnbGVJY29uID0gJCgnLnRvZ2dsZS1pY29uJyk7XHJcblxyXG4gICAgICAgIG5hdkNvbnRhaW5lci50b2dnbGUoKVxyXG4gICAgICAgIGlmICggbmF2Q29udGFpbmVyLmlzKFwiOnZpc2libGVcIikpIHtcclxuICAgICAgICAgICAgdG9nZ2xlSWNvbi5yZW1vdmVDbGFzcygnZmEtYXJyb3ctcmlnaHQnKS5hZGRDbGFzcygnZmEtYXJyb3ctbGVmdCcpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0b2dnbGVJY29uLnJlbW92ZUNsYXNzKCdmYS1hcnJvdy1sZWZ0JykuYWRkQ2xhc3MoJ2ZhLWFycm93LXJpZ2h0JylcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn1cclxuXHJcbmxldCB2aWV3TW9kZWwgPSBuZXcgQXBwVmlld01vZGVsKClcclxuXHJcbi8qIElOSVRJQUxJWklORyBUSEUgTUFQICovXHJcbmZ1bmN0aW9uIGluaXRNYXAoKSB7XHJcbiAgICAvLyBHRVQgVEhFIE1BUCBDT05UQUlORVIgQU5EIFNFVCBUSEUgT1BUSU9OU1xyXG4gICAgY29uc3QgbWFwQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xyXG4gICAgY29uc3QgbWFwT3B0aW9ucyA9IHtcclxuICAgICAgICBjZW50ZXI6IHtsYXQ6IDM3Ljg1NTIyMSwgbG5nOiAtMTIyLjQ3ODgzMX0sXHJcbiAgICAgICAgem9vbTogMTQsXHJcbiAgICAgICAgbWFwVHlwZUlkOiAncm9hZG1hcCdcclxuICAgIH07XHJcblxyXG4gICAgLy9JTklUSUFMSVpFIFRIRSBNQVBcclxuICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAobWFwQ29udGFpbmVyLCBtYXBPcHRpb25zKTtcclxuXHJcbiAgICAvKiBMT09QIFRPIENSRUFURSBNQVJLRVIgUEVSIEVBQ0ggTE9DQVRJT04gKi9cclxuICAgIHZpZXdNb2RlbC5sb2NhdGlvbnMoKS5mb3JFYWNoKCggbG9jYXRpb24sIGkgKSA9PiB7XHJcbiAgICAgICAgbGV0IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogbG9jYXRpb24ucG9zaXRpb24sXHJcbiAgICAgICAgICAgIG1hcDogbWFwLFxyXG4gICAgICAgICAgICBuYW1lOiBsb2NhdGlvbi5uYW1lLFxyXG4gICAgICAgICAgICBpbWFnZTogbG9jYXRpb24uaW1hZ2UsXHJcbiAgICAgICAgICAgIHJhdGluZzogbG9jYXRpb24ucmF0aW5nLFxyXG4gICAgICAgICAgICBhZGRyZXNzOiBsb2NhdGlvbi5hZGRyZXNzLFxyXG4gICAgICAgICAgICBpZDogaVxyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaW5mb1dpbmRvdyA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KCk7XHJcblxyXG4gICAgICAgIG1hcmtlci5hZGRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KCBgXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJpbmZvV2luZG93XCI+XHJcbiAgICAgICAgICAgICAgICA8aDMgY2xhc3M9XCJuYW1lXCI+JHttYXJrZXIubmFtZX08L2gzPlxyXG4gICAgICAgICAgICAgICAgPGg0IGNsYXNzPVwicmF0aW5nXCI+WWVscCBSYXRpbmc6ICR7bWFya2VyLnJhdGluZ308L2g0PlxyXG4gICAgICAgICAgICAgICAgPHA+JHttYXJrZXIuYWRkcmVzc308L3A+XHJcbiAgICAgICAgICAgICAgICA8aW1nIHNyYz1cIiR7bWFya2VyLmltYWdlfVwiPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgYClcclxuICAgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCwgbWFya2VyKTtcclxuICAgICAgICAgICAgdmlld01vZGVsLnNpZ25hbEhpZ2hsaXRlZChtYXJrZXIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBtYXJrZXJzLnB1c2gobWFya2VyKTtcclxuXHJcbiAgICAgICAgXHJcbiAgICB9KTtcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldExvY2F0aW9uc0Zyb21ZZWxwKCkge1xyXG4gICAgZmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6MzMzMycpXHJcbiAgICAgICAgLnRoZW4oIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCApIHtcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKCAoIGRhdGEgKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrIHRoZSBiYWNrZW5kJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld01vZGVsLmxvY2F0aW9ucyhiYWNrdXBMb2NhdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGluaXRNYXAoKVxyXG5cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXNwb25zZS5qc29uKCkudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goKCBpdGVtICkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uaGlnaGxpZ2h0ZWQgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB2aWV3TW9kZWwubG9jYXRpb25zKGRhdGEpXHJcbiAgICAgICAgICAgICAgICBpbml0TWFwKClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCggZnVuY3Rpb24oIGVyciApIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZldGNoIEVycm9yIDotUycsIGVycik7XHJcbiAgICAgICAgICAgIHZpZXdNb2RlbC5sb2NhdGlvbnMoYmFja3VwTG9jYXRpb25zKTtcclxuICAgICAgICAgICAgaW5pdE1hcCgpXHJcbiAgICAgICAgfSlcclxufVxyXG5cclxuZ2V0TG9jYXRpb25zRnJvbVllbHAoKVxyXG5cclxuXHJcbmtvLmFwcGx5QmluZGluZ3Modmlld01vZGVsKSJdfQ==
